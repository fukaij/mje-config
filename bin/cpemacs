#!/bin/sh
#
# cpemacs - Copy emacs files into site-lisp directory and recompile them
# Written by Martin Ebourne, Started 24/08/99
#
# $Id: cpemacs,v 1.5 2000/12/11 14:35:17 mebourne Exp $

fromdir=$HOME/config/emacs-site
todir=$HOME/local/share/emacs/site-lisp

cd $fromdir

filelist=""
for i in *.el
do
  destfile=$todir/$i
  echo "Installing $destfile"
  rm -f $destfile
  cp -p $i $destfile
  chmod 444 $destfile
  filelist="$filelist \"$destfile\""
done

echo "Running Emacs to byte compile files..."

emacs --batch --eval "(mapcar 'byte-compile-file (list $filelist))"
