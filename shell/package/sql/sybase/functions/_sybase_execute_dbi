# ZSH function file
# Part of the SQL Sybase package
# Enter an SQL command via Perl DBI
# For use only by the SQL packages
#
# $Id: _sybase_execute_dbi 792 2003-09-22 11:47:18Z martin $

if [[ -z $_sql_parameters[user] ]]
then
  echo "Error: SQL user variable not set" 1>&2
  return 1
fi

# Build the connect string
local -a connect
connect=(
  ${_sql_parameters[server]:+server=$_sql_parameters[server]}
  ${_sql_parameters[database]:+database=$_sql_parameters[server]}
)

$_sql_dbiprogram --driver=Sybase \
                 ${connect:+--connect=${(j:;:)connect}} \
                 --user=$_sql_parameters[user] \
                 ${_sql_parameters[password]:+--password=$_sql_parameters[password]} \
                 "$argv[@]"
