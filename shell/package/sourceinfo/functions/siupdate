# ZSH function file
# Written by Martin Ebourne
# Part of the SourceInfo package
# Update the SourceInfo databases
# Usage: siupdate
#
# $Id: siupdate,v 1.6 2001/04/11 11:14:30 mebourne Exp $

if [[ -z $sourceinfo_sourcecode_dirs ]]
then
  echo "sourceinfo_sourcecode_dirs not set" 1>&2
  return 1
fi

# Create the files database
local dir
for dir in $sourceinfo_sourcecode_dirs
do
  find $dir -type f \! \( -name '*.[ao]' -o -name '*.so' -o -name '*[mM]akefile' \
			  -o -name sol2.d -o -name '.*' -o -name '*~' -o -name '*#' \
			  -o -name core \
		       \) \
		    -print \
	    -o -name lost+found -prune
done |
  gzip - > $sourceinfo_filesdb

# Create the types database
for dir in $sourceinfo_sourcecode_dirs
do
  find $dir -type f \( -name '*.hpp' -o -name '*.h' \) -print \
	    -o -name lost+found -prune | xargs typeInfoGenerate.pl
done |
  gzip - > $sourceinfo_typesdb
