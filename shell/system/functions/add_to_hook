#eval compdef -n _parse_opts add_to_hook
# ZSH function file
# Add command to function if not already present. Makes a function
# usable as a hook a al emacs
#
# $Id: add_to_hook,v 1.5 2001/08/01 19:37:08 mebourne Exp $

local -a args
args=($argv[*])
local -A opts

local -a command

parse_opts args opts <<'EOF' || return 1
Description:
Add command to function if not already present. Makes a function usable as a
hook a al emacs. If the function does not already exist then it will be
created with 'setopt noxtrace' at the top in order to prevent the shell
tracing the hook

Usage:
add_to_hook [options] <function-name> <command> ...

Options:
  -h, --help			Provide this help
				# help | h

Arguments:
  <function-name>		The function to be edited
				# funcname = [1] = string
  <command> ...			The command words to be added
				# [command] = [1,*] = string
EOF

if [[ -z $functions[$opts[funcname]] ]]
then
  functions[$opts[funcname]]="setopt noxtrace
"
fi

functions[$opts[funcname]]="${functions[$opts[funcname]]//$command[@]}
$command[@]
"
