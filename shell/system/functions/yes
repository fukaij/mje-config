#eval compdef -n _parse_opts yes
# ZSH function file
# Repeatedly print a string
#
# $Id: yes,v 1.8 2001/08/02 12:13:17 mebourne Exp $

local -A opts
opts[lines]=-1

parse_opts - opts -- "$argv[@]" <<'EOF' || return 1
Description:
Repeatedly print a string

Usage:
yes [options] [<text> ...]

Options:
  -e, --escape			Interpret escape characters as for echo (default unless
				the BSD_ECHO option is set)
				# [echoopt] += --escape | -e : constant=-e
  -E, --no-escape		Prevent interpretation of escape characters
				# [echoopt] += --no-escape | -E : constant=-E
  -h, --help			Provide this help
				# --help | -h
  -l <count>, --lines=<count>	Output only count times
				# --lines | -l : integer
  -n, --no-newline		Suppress output of automatic newline
				# [echoopt] += --no-newline | -n : constant=-n
  -s <seconds>, --sleep=<seconds>
				Pause for number of seconds between each echo
				# --sleep | -s : integer

Arguments:
  [<text> ...]			Optional text to print. Defaults to 'yes'
				# [text] += [*] text : string
EOF

# Default text to 'yes' if no parameters passed
if (( ! $+opts[text] ))
then
  opts[text]="yes"
fi

# Output as required
while (( opts[lines] ))
do
  echo $=opts[echoopt] $opts[text]
  (( opts[sleep] )) && sleep $opts[sleep]
  (( opts[lines] > 0 && opts[lines]-- ))
done
